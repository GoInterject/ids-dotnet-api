<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Multi-Col RowDef Items | Interject .Net API </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Multi-Col RowDef Items | Interject .Net API ">
    <meta name="generator" content="docfx 2.59.4.0">
    
    <link rel="shortcut icon" href="../../../favicon.ico">
    <link rel="stylesheet" href="../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../styles/main.css">
    <meta property="docfx:navrel" content="../../../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    <meta property="docfx:rel" content="../../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../../index.html">
                <img id="logo" class="svg" src="../../../interject.png" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="multi-col-rowdef-items">Multi-Col RowDef Items</h1>

<p>The <a href="https://docs.gointerject.com/wIndex/ReportVariable.html#function-arguments">RowDefRange</a> parameter defines a range of RowDefItems. The RowDefItems define where to map the data being returned to Interject from the API for a <a href="https://docs.gointerject.com/wIndex/ReportFixed.html">ReportFixed</a> or <a href="https://docs.gointerject.com/wIndex/ReportVariable.html">ReportVariable</a>.</p>
<p>Starting with Interject ver 2.5x, this RowDefRange can be a multi-column range. In this case, the combination of column values provide a unique <em>key</em> for matching up the data.</p>
<h2 id="rowdef-items">RowDef Items</h2>
<p>The RowDef Items are packaged as XML by Interject and parsed in the object <code>InterjectRequestContext.RowDefItems</code>. In order for Interject to match up the data for these RowDef Items, there needs to be a column returned from the API called &quot;RowDefName.&quot; If the data source does not return a column called &quot;RowDefName&quot;, Interject will use the value defined in the Column Definition range in the same column as the RowDef Items.</p>
<h2 id="example-1---multiple-column-rowdefrange">Example 1 - Multiple Column RowDefRange</h2>
<h3 id="the-report">The Report</h3>
<p>The following is an Excel report that shows multiple columns in the RowDefRange. Note the columns &quot;div&quot; and &quot;loc&quot; are the 2 columns that constitute the RowDefRange. In order to process the data to be returned to this report, the columns need to have matching names in the IDS Table (&quot;div&quot; and &quot;loc&quot;).</p>
<p><em>* This report can be found in the example.xlsx report in the <code>examples</code> folder.</em></p>
<p><img src="../../static/report-variable.png" alt="">
<br></p>
<h3 id="code">Code</h3>
<pre><code class="lang-csharp">        [HttpPost(&quot;ReportVariable&quot;)]
        [ProducesResponseType(typeof(InterjectResponse), 200)]
        public InterjectResponse TestReportVariable([FromBody] InterjectRequest interjectRequest)
        {
            // Create an instance of the InterjectResponse to return by passing in the
            // InterjectRequest from the request. This copies the parameter list from
            // the request into the response.
            InterjectResponse response = new(interjectRequest);

            var requestContext = interjectRequest.GetRequestContext();

            try
            {
                // (Optional) Get Data Portal formula parameter values.
                string reportParam1 = interjectRequest.GetParameterValue&lt;string&gt;(&quot;CompanyName&quot;);
                string reportParam2 = interjectRequest.GetParameterValue&lt;string&gt;(&quot;ContactName&quot;);
                string reportParam3 = interjectRequest.GetParameterValue&lt;string&gt;(&quot;CustomerID&quot;);

                // (Optional) Process Column Definition Items.
                List&lt;InterjectColDefItem&gt; colDefItems = interjectRequest.GetColDefItems();
                colDefItems.ForEach(item =&gt;
                {
                    Console.WriteLine(item.ToXML());
                });

                // (Optional) Process Row Definition Items.
                List&lt;InterjectRowDefItem&gt; rowDefItems = interjectRequest.GetRowDefItems();
                rowDefItems.ForEach(item =&gt;
                {
                    Console.WriteLine(item.ToXML());
                });

                foreach (InterjectColDefItem item in colDefItems)
                {
                    Console.Write(item.ToString());
                }

                // Assemble data to return to Interject to be populated on the spreadsheet.
                IdsTable table = new();
                table.AddColumn(new(&quot;div&quot;));
                table.AddColumn(new(&quot;loc&quot;));
                table.AddColumn(new(&quot;acct&quot;));
                table.AddColumn(new(&quot;MTD&quot;));
                table.AddColumn(new(&quot;QTD&quot;));
                table.AddColumn(new(&quot;YTD&quot;));
                table.AddRow(new() { &quot;701&quot;, &quot;123&quot;, &quot;3333&quot;, &quot;94.30&quot;, &quot;904.34&quot;, &quot;9804.34&quot; });
                table.AddRow(new() { &quot;701&quot;, &quot;123&quot;, &quot;3334&quot;, &quot;94.31&quot;, &quot;904.34&quot;, &quot;9804.34&quot; });
                table.AddRow(new() { &quot;701&quot;, &quot;124&quot;, &quot;3334&quot;, &quot;94.32&quot;, &quot;904.34&quot;, &quot;9804.34&quot; });
                table.AddRow(new() { &quot;701&quot;, &quot;124&quot;, &quot;3334&quot;, &quot;94.33&quot;, &quot;904.34&quot;, &quot;9804.34&quot; });
                table.AddRow(new() { &quot;701&quot;, &quot;124&quot;, &quot;3335&quot;, &quot;94.34&quot;, &quot;904.34&quot;, &quot;9804.34&quot; });
                table.AddRow(new() { &quot;702&quot;, &quot;223&quot;, &quot;3333&quot;, &quot;94.35&quot;, &quot;904.34&quot;, &quot;9804.34&quot; });
                table.AddRow(new() { &quot;702&quot;, &quot;224&quot;, &quot;3334&quot;, &quot;94.36&quot;, &quot;904.34&quot;, &quot;9804.34&quot; });
                table.AddRow(new() { &quot;702&quot;, &quot;225&quot;, &quot;3333&quot;, &quot;94.37&quot;, &quot;904.34&quot;, &quot;9804.34&quot; });
                table.AddRow(new() { &quot;703&quot;, &quot;320&quot;, &quot;3334&quot;, &quot;94.38&quot;, &quot;904.34&quot;, &quot;9804.34&quot; });
                table.AddRow(new() { &quot;703&quot;, &quot;320&quot;, &quot;3335&quot;, &quot;94.39&quot;, &quot;904.34&quot;, &quot;9804.34&quot; });
                table.AddRow(new() { &quot;703&quot;, &quot;321&quot;, &quot;3333&quot;, &quot;94.40&quot;, &quot;904.34&quot;, &quot;9804.34&quot; });
                table.AddRow(new() { &quot;703&quot;, &quot;321&quot;, &quot;3335&quot;, &quot;94.41&quot;, &quot;904.34&quot;, &quot;9804.34&quot; });
                table.AddRow(new() { &quot;705&quot;, &quot;501&quot;, &quot;3335&quot;, &quot;94.42&quot;, &quot;904.34&quot;, &quot;9804.34&quot; });
                table.AddRow(new() { &quot;705&quot;, &quot;520&quot;, &quot;3333&quot;, &quot;94.43&quot;, &quot;904.34&quot;, &quot;9804.34&quot; });
                table.AddRow(new() { &quot;705&quot;, &quot;520&quot;, &quot;3334&quot;, &quot;94.44&quot;, &quot;904.34&quot;, &quot;9804.34&quot; });

                // (Optional) Show contents of Interject Table object.
                Console.Write(table.ToString());

                // (Required) Add the table to the InterjectResponse object.
                response.AddReturnedData(table);
            }
            catch (Exception e)
            {
                Console.WriteLine(e.Message);
                Console.Write(e.StackTrace);
                response.ErrorMessage = e.Message;
            }

            return response;
        }
    }
</code></pre><h2 id="example-2---single-column-rowdefrange-using-pipe-delimiter">Example 2 - Single Column RowDefRange Using Pipe Delimiter</h2>
<h3 id="the-report-1">The Report</h3>
<p>This example uses a single column for the RowDefRange but some of the entries contain multiple values delimited by the default pipe delimiter &#39;|&#39;. Note there is no value in B2 and it is not needed as the data returned includes the column &quot;RowDefName&quot;.</p>
<p><em>* This report can be found in the example.xlsx report in the <code>examples</code> folder.</em></p>
<p><img src="../../static/row-def.png" alt="">
<br>
<br></p>
<h3 id="code-1">Code</h3>
<pre><code class="lang-csharp">    [HttpPost(&quot;ReportRowDef&quot;)]
    [ProducesResponseType(typeof(InterjectResponse), 200)]
    public InterjectResponse TestRowDef([FromBody] InterjectRequest interjectRequest)
    {
        // Create an instance of the InterjectResponse to return by passing in the
        // InterjectRequest from the request. This copies the parameter list from
        // the request into the response.
        InterjectResponse response = new(interjectRequest);

        var requestContext = interjectRequest.GetRequestContext();

        try
        {
            // (Optional) Get Data Portal formula parameter values.
            string reportParam1 = interjectRequest.GetParameterValue&lt;string&gt;(&quot;CompanyName&quot;);
            string reportParam2 = interjectRequest.GetParameterValue&lt;string&gt;(&quot;ContactName&quot;);
            string reportParam3 = interjectRequest.GetParameterValue&lt;string&gt;(&quot;CustomerID&quot;);

            // (Optional) Process Column Definition Items.
            List&lt;InterjectColDefItem&gt; colDefItems = interjectRequest.GetColDefItems();
            colDefItems.ForEach(item =&gt;
            {
                Console.WriteLine(item.ToXML());
            });

            // (Optional) Process Row Definition Items.
            List&lt;InterjectRowDefItem&gt; rowDefItems = interjectRequest.GetRowDefItems();
            rowDefItems.ForEach(item =&gt;
            {
                Console.WriteLine(item.ToXML());
            });

            foreach (InterjectColDefItem item in colDefItems)
            {
                Console.Write(item.ToString());
            }

            // Assemble data to return to Interject to be populated on the spreadsheet.
            IdsTable table = new();
            table.AddColumn(new(&quot;RowDefName&quot;));
            table.AddColumn(new(&quot;div&quot;));
            table.AddColumn(new(&quot;loc&quot;));
            table.AddColumn(new(&quot;acct&quot;));
            table.AddColumn(new(&quot;MTD&quot;));
            table.AddColumn(new(&quot;QTD&quot;));
            table.AddColumn(new(&quot;YTD&quot;));
            table.AddRow(new() { &quot;701&quot;, &quot;701&quot;, &quot;123&quot;, &quot;3333&quot;, &quot;94.30&quot;, &quot;904.34&quot;, &quot;9804.34&quot; });
            table.AddRow(new() { &quot;701&quot;, &quot;701&quot;, &quot;123&quot;, &quot;3334&quot;, &quot;94.31&quot;, &quot;904.34&quot;, &quot;9804.34&quot; });
            table.AddRow(new() { &quot;701&quot;, &quot;701&quot;, &quot;124&quot;, &quot;3334&quot;, &quot;94.32&quot;, &quot;904.34&quot;, &quot;9804.34&quot; });
            table.AddRow(new() { &quot;701&quot;, &quot;701&quot;, &quot;124&quot;, &quot;3334&quot;, &quot;94.33&quot;, &quot;904.34&quot;, &quot;9804.34&quot; });
            table.AddRow(new() { &quot;701&quot;, &quot;701&quot;, &quot;124&quot;, &quot;3335&quot;, &quot;94.34&quot;, &quot;904.34&quot;, &quot;9804.34&quot; });
            table.AddRow(new() { &quot;702&quot;, &quot;702&quot;, &quot;223&quot;, &quot;3333&quot;, &quot;94.35&quot;, &quot;904.34&quot;, &quot;9804.34&quot; });
            table.AddRow(new() { &quot;702&quot;, &quot;702&quot;, &quot;224&quot;, &quot;3334&quot;, &quot;94.36&quot;, &quot;904.34&quot;, &quot;9804.34&quot; });
            table.AddRow(new() { &quot;702&quot;, &quot;702&quot;, &quot;225&quot;, &quot;3333&quot;, &quot;94.37&quot;, &quot;904.34&quot;, &quot;9804.34&quot; });
            table.AddRow(new() { &quot;702&quot;, &quot;702&quot;, &quot;225&quot;, &quot;3334&quot;, &quot;94.38&quot;, &quot;904.34&quot;, &quot;9804.34&quot; });
            table.AddRow(new() { &quot;702&quot;, &quot;702&quot;, &quot;225&quot;, &quot;3335&quot;, &quot;94.39&quot;, &quot;904.34&quot;, &quot;9804.34&quot; });

            // (Optional) Show contents of Interject Table object.
            Console.Write(table.ToString());

            // (Required) Add the table to the InterjectResponse object.
            response.AddReturnedData(table);
        }
        catch (Exception e)
        {
            Console.WriteLine(e.Message);
            Console.Write(e.StackTrace);
            response.ErrorMessage = e.Message;
        }

        return response;
    }
}
</code></pre><h2 id="example-3---rowdefrange-explicitly-labeled">Example 3 - RowDefRange Explicitly Labeled</h2>
<h3 id="the-report-2">The Report</h3>
<p>This example uses multiple columns for the RowDefRange but each RowDefItem is explicitly labeled in the code (i.e. R00001, R00002, etc.). Therefore, there you can name the row def item anything in the report.</p>
<p><em>* This report can be found in the example.xlsx report in the <code>examples</code> folder.</em></p>
<p><img src="../../static/row-def-name.png" alt="">
<br></p>
<h3 id="code-2">Code</h3>
<pre><code class="lang-csharp">[HttpPost(&quot;ReportRowDefName&quot;)]
[ProducesResponseType(typeof(InterjectResponse), 200)]
public InterjectResponse TestRowDefName([FromBody] InterjectRequest interjectRequest)
{
    // Create an instance of the InterjectResponse to return by passing in the
    // InterjectRequest from the request. This copies the parameter list from
    // the request into the response.
    InterjectResponse response = new(interjectRequest);

    var requestContext = interjectRequest.GetRequestContext();

    try
    {
        // (Optional) Get Data Portal formula parameter values.
        string reportParam1 = interjectRequest.GetParameterValue&lt;string&gt;(&quot;CompanyName&quot;);
        string reportParam2 = interjectRequest.GetParameterValue&lt;string&gt;(&quot;ContactName&quot;);
        string reportParam3 = interjectRequest.GetParameterValue&lt;string&gt;(&quot;CustomerID&quot;);

        // (Optional) Process Column Definition Items.
        List&lt;InterjectColDefItem&gt; colDefItems = interjectRequest.GetColDefItems();
        colDefItems.ForEach(item =&gt;
        {
            Console.WriteLine(item.ToXML());
        });

        // (Optional) Process Row Definition Items.
        List&lt;InterjectRowDefItem&gt; rowDefItems = interjectRequest.GetRowDefItems();
        rowDefItems.ForEach(item =&gt;
        {
            Console.WriteLine(item.ToXML());
        });


        foreach (InterjectColDefItem item in colDefItems)
        {
            Console.Write(item.ToString());
        }

        // Assemble data to return to Interject to be populated on the spreadsheet.
        IdsTable table = new();
        table.AddColumn(new(&quot;RowDefName&quot;));
        table.AddColumn(new(&quot;div&quot;));
        table.AddColumn(new(&quot;loc&quot;));
        table.AddColumn(new(&quot;acct&quot;));
        table.AddColumn(new(&quot;MTD&quot;));
        table.AddColumn(new(&quot;QTD&quot;));
        table.AddColumn(new(&quot;YTD&quot;));
        table.AddRow(new() { &quot;R00001&quot;, &quot;701&quot;, &quot;123&quot;, &quot;3333&quot;, &quot;94.30&quot;, &quot;904.34&quot;, &quot;9804.34&quot; });
        table.AddRow(new() { &quot;R00001&quot;, &quot;701&quot;, &quot;123&quot;, &quot;3334&quot;, &quot;94.31&quot;, &quot;904.34&quot;, &quot;9804.34&quot; });
        table.AddRow(new() { &quot;R00001&quot;, &quot;701&quot;, &quot;124&quot;, &quot;3334&quot;, &quot;94.32&quot;, &quot;904.34&quot;, &quot;9804.34&quot; });
        table.AddRow(new() { &quot;R00001&quot;, &quot;701&quot;, &quot;124&quot;, &quot;3334&quot;, &quot;94.33&quot;, &quot;904.34&quot;, &quot;9804.34&quot; });
        table.AddRow(new() { &quot;R00001&quot;, &quot;701&quot;, &quot;124&quot;, &quot;3335&quot;, &quot;94.34&quot;, &quot;904.34&quot;, &quot;9804.34&quot; });
        table.AddRow(new() { &quot;R00002&quot;, &quot;702&quot;, &quot;223&quot;, &quot;3333&quot;, &quot;94.35&quot;, &quot;904.34&quot;, &quot;9804.34&quot; });
        table.AddRow(new() { &quot;R00002&quot;, &quot;702&quot;, &quot;224&quot;, &quot;3334&quot;, &quot;94.36&quot;, &quot;904.34&quot;, &quot;9804.34&quot; });
        table.AddRow(new() { &quot;R00002&quot;, &quot;702&quot;, &quot;225&quot;, &quot;3333&quot;, &quot;94.37&quot;, &quot;904.34&quot;, &quot;9804.34&quot; });
        table.AddRow(new() { &quot;R00002&quot;, &quot;702&quot;, &quot;225&quot;, &quot;3334&quot;, &quot;94.38&quot;, &quot;904.34&quot;, &quot;9804.34&quot; });
        table.AddRow(new() { &quot;R00002&quot;, &quot;702&quot;, &quot;225&quot;, &quot;3335&quot;, &quot;94.39&quot;, &quot;904.34&quot;, &quot;9804.34&quot; });
        table.AddRow(new() { &quot;R00003&quot;, &quot;703&quot;, &quot;320&quot;, &quot;3335&quot;, &quot;94.35&quot;, &quot;904.34&quot;, &quot;9804.34&quot; });
        table.AddRow(new() { &quot;R00003&quot;, &quot;703&quot;, &quot;321&quot;, &quot;3335&quot;, &quot;94.36&quot;, &quot;904.34&quot;, &quot;9804.34&quot; });
        table.AddRow(new() { &quot;R00003&quot;, &quot;703&quot;, &quot;322&quot;, &quot;3333&quot;, &quot;94.37&quot;, &quot;904.34&quot;, &quot;9804.34&quot; });
        table.AddRow(new() { &quot;R00003&quot;, &quot;703&quot;, &quot;322&quot;, &quot;3334&quot;, &quot;94.38&quot;, &quot;904.34&quot;, &quot;9804.34&quot; });
        table.AddRow(new() { &quot;R00003&quot;, &quot;703&quot;, &quot;322&quot;, &quot;3335&quot;, &quot;94.39&quot;, &quot;904.34&quot;, &quot;9804.34&quot; });

        // (Optional) Show contents of Interject Table object.
        Console.Write(table.ToString());

        // (Required) Add the table to the InterjectResponse object.
        response.AddReturnedData(table);
    }
    catch (Exception e)
    {
        Console.WriteLine(e.Message);
        Console.Write(e.StackTrace);
        response.ErrorMessage = e.Message;
    }

    return response;
}
</code></pre></article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/GoInterject/ids-dotnet-api/blob/sr-lc527-updated_docs/docs/source/pages/examples/MultiRowdefCols.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            Interject ®
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../styles/main.js"></script>
  </body>
</html>
